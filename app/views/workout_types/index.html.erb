<% if @workout_types.exists? %>
	
	<div class="search-box pull-right">
		<%= form_tag(workout_types_path, :method => "get", id: "search-form") do %>
	    <div class="input-append">
	      <%= text_field_tag :search, params[:search], class: "span2", id: "search-input", placeholder: "Enter search terms"%>
	      <!-- In order to have the "search" icon in the button, we need to use plain HTML instead 
	           of using a Rails form helper -->
	      <button class="btn btn-default btn-sm" id="search-button" type="submit">Search Routines</button>
	    </div>
	  <% end %>
	</div>

	<div class="clear"></div>

	<ul class="nav nav-tabs">
	  <li class="active"><a data-toggle="tab" href="#home">All Public Workout Routines 
	  	<span class="badge" id="public_routines_badge"><%= @workout_types.where(public: true).count %></span></a>
	  </li>
	  <li><a data-toggle="tab" href="#menu1">My Workout Routines
	  	<span class="badge" id="my_routines_badge"><%= @workout_types.where(user_id: current_user).count %></span></a>
	  </li>
	</ul>

	<div class="tab-content">
	  <div id="home" class="tab-pane fade in active">
	    <h3>Public Routines</h3>
	    <% @workout_types.each do |workout_type| %>
				<% if workout_type.public == true %>
					<div class="workout-box col-xs-10 col-xs-offset-1">
						<p class="workout_type-name"><%= link_to workout_type.type_name, workout_type_path(workout_type) %></p>
						<p><%= truncate(workout_type.description, length: 200) %></p>
						<% workout_type.exercise_types.each do |exercise_type| %>
							<div><%= exercise_type.name %></div>
						<% end %>
						<br />

						<% if workout_type.user.present? %>
			      	<small>Added by: <%= workout_type.user.username %></small> | 
			      	Used <span class="badge"><%= Workout.where(workout_type_id: workout_type.id).count %></span> times
			    	<% end %>
			    	<br />

			    	<!-- action buttons --> 
			    	<div>
			    		<%= link_to workout_type_path(workout_type), :class => 'btn btn-primary' do %>
								View / Discuss&nbsp;
								<span class="glyphicon glyphicon-search" aria-hidden="true"></span>
							<% end %>

							<% if user_signed_in? && workout_type.user == current_user %>
								<%= link_to edit_workout_type_path(workout_type), :class => 'btn btn-primary' do %>
									Edit &nbsp;
									<span class="glyphicon glyphicon-edit" aria-hidden="true"></span>
								<% end %>
								<%= link_to workout_type_remove_path(workout_type), data: {confirm: "Are you sure you want to delete this routine?"}, :class => 'btn btn-danger' do %>
									Delete &nbsp;
									<span class="glyphicon glyphicon-trash" aria-hidden="true"></span>
								<% end %>
							<% end %>

							<% if user_signed_in? %>
								<%= link_to new_workout_type_workout_path(workout_type), :class => 'btn btn-primary' do %>
									Record Results &nbsp;
									<span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
								<% end %>
							<% else %>
								<%= link_to new_user_session_path, :class => 'btn btn-primary' do %>
									Record Results &nbsp;
									<span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
								<% end %>
							<% end %>				
						</div>
						<!-- end action buttons --> 
					</div>
				<% end %>	
			<% end %>
	  </div>

	  <div id="menu1" class="tab-pane">
	  	<% if user_signed_in? %>
	      <h3>My Routines</h3>
	      <% @workout_types.each do |workout_type| %>
					<% if workout_type.user == current_user %>
						<div class="workout-box col-xs-10 col-xs-offset-1">
							<p class="workout_type-name"><%= link_to workout_type.type_name, workout_type_path(workout_type) %>
								<span class="badge">
									<% if workout_type.public == true %>
										Public
									<% else %>
										Private
									<% end %>
								</span>
							</p>
							<p><%= truncate(workout_type.description, length: 200) %></p>
							<% workout_type.exercise_types.each do |exercise_type| %>
								<div><%= exercise_type.name %></div>
							<% end %>
							<br />
							<% if workout_type.user.present? %>
				      	<small>Added by: <%= workout_type.user.username %></small>
				    	<% end %>
				    	<br />
				    	<div>
					    	<%= link_to workout_type_path(workout_type), :class => 'btn btn-primary' do %>
									View &nbsp;
									<span class="glyphicon glyphicon-search" aria-hidden="true"></span>
								<% end %>
								<%= link_to edit_workout_type_path(workout_type), :class => 'btn btn-primary' do %>
									Edit &nbsp;
									<span class="glyphicon glyphicon-edit" aria-hidden="true"></span>
								<% end %>
								<%= link_to new_workout_type_workout_path(workout_type), :class => 'btn btn-primary' do %>
									Record Your Results &nbsp;
									<span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
								<% end %>
							</div>
						</div>
					<% end %>	
				<% end %>
			<% else %>
				<h2>Please <%= link_to 'sign in', new_user_session_path =%> to view your Routines.</h2>
			<% end %>
	  </div>
	</div>
<% else %>
	<br />
	<hr>
	<h2>No routines have yet been added. Please click on <%= link_to 'New Workout Routine', new_workout_type_path =%> to add a new routine.</h2>
<% end %>

<!-- </div> -->